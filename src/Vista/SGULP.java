package Vista;

import modelo.Conexion;
import Persistencia.AlumnoData;      
import Persistencia.MateriaData;     
import Persistencia.InscripcionData;

public class SGULP extends javax.swing.JFrame {
    private AlumnoData alumnoData;
    private MateriaData materiaData;
    private InscripcionData inscripcionData;
    private Conexion conexion;
    /**
     * Creates new form NewJFrame
     */
    public SGULP(AlumnoData ad, MateriaData md, InscripcionData id) { 
        initComponents();
        this.setLocationRelativeTo(null);
        this.alumnoData = ad; 
        this.materiaData = md; 
        this.inscripcionData = id; 
    
        try {
            // **IMPORTANTE**: Revisa que los parámetros de tu BD sean correctos
            conexion = new Conexion("jdbc:mariadb://localhost:3306/sgulp", "root", ""); 
            alumnoData = new AlumnoData(conexion);
        } catch (Exception ex) {
            // Manejo de errores de conexión/inicialización
            System.err.println("Error al iniciar la Conexión o AlumnoData: " + ex.getMessage());
            // Si la conexión falla, es un error grave.
        }
    
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jDesktopPane1 = new javax.swing.JDesktopPane();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jmalumno = new javax.swing.JMenuItem();
        jmateria = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        javax.swing.GroupLayout jDesktopPane1Layout = new javax.swing.GroupLayout(jDesktopPane1);
        jDesktopPane1.setLayout(jDesktopPane1Layout);
        jDesktopPane1Layout.setHorizontalGroup(
            jDesktopPane1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 471, Short.MAX_VALUE)
        );
        jDesktopPane1Layout.setVerticalGroup(
            jDesktopPane1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 341, Short.MAX_VALUE)
        );

        jMenu1.setBorder(javax.swing.BorderFactory.createCompoundBorder());
        jMenu1.setForeground(new java.awt.Color(0, 0, 153));
        jMenu1.setText("Vistas");

        jmalumno.setText("Vista Alumno");
        jMenu1.add(jmalumno);

        jmateria.setText("Vista Materia");
        jMenu1.add(jmateria);

        jMenuBar1.add(jMenu1);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jDesktopPane1)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jDesktopPane1)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents
    
    private void jmalumnoActionPerformed(java.awt.event.ActionEvent evt) {                                         
        // 🔑 VALIDACIÓN DE SEGURIDAD: Verifica si la conexión falló al inicio.
        if (alumnoData == null) {
            javax.swing.JOptionPane.showMessageDialog(this, 
                "Error Crítico: No se pudo establecer la conexión a la base de datos (alumnoData es NULL).", 
                "Error de Inicialización", 
                javax.swing.JOptionPane.ERROR_MESSAGE);
            return; // Si es nulo, detenemos la ejecución aquí.
        }
        for (javax.swing.JInternalFrame frame : jDesktopPane1.getAllFrames()) {
            if (frame instanceof VistaAlumno) {
                frame.toFront();
                return;
            }
        }
        
        // Abre la vista de Alumno y le pasa la capa de datos
        VistaAlumno va = new VistaAlumno(alumnoData, jDesktopPane1);
        jDesktopPane1.add(va);
        va.setVisible(true);
        va.moveToFront(); 
    }                                        

    
    private void jmateriaActionPerformed(java.awt.event.ActionEvent evt) {                                         
        
    }
    

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JDesktopPane jDesktopPane1;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jmalumno;
    private javax.swing.JMenuItem jmateria;
    // End of variables declaration//GEN-END:variables
}
